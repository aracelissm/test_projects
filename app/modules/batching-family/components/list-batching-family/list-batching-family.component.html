<main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 mt-2">
    <app-recent-activity></app-recent-activity>
    <div>
        <h2 class="title-v1 mb-1">Batching Family Management</h2>
    </div>

    <button type="button" class="btn btn-outline-dark cu-btnlist" *hasPermission="'CRBATCHINGFAMILY'"
        (click)="onClickCreateBatchingFamily()">
        <i class="fas fa-plus"></i>&nbsp;
        <span class="ml-3">Batching Family</span>
    </button>
    <div class="demo-container datagrid-wrapper custom-datagrid-pager-exists" *hasPermission="'REBATCHINGFAMILY'">
        <dx-data-grid [height]="dataGridHeight" [dataSource]="dataSource" keyExpr="id"
            noDataText="No Batching Families Found" (onExporting)="onExporting($event)"
            (onContentReady)="onContentReady($event)">
            <dxo-export [enabled]="true"></dxo-export>
        <dxo-column-chooser #columnChooser [allowSearch]="true" [enabled]="true" [mode]="columnChooserModes[1].key">
            <dxo-position my="right top" at="right bottom" of=".dx-datagrid-column-chooser-button"></dxo-position>
        </dxo-column-chooser>
            <dxo-state-storing [enabled]="true" type="custom" [customLoad]="loadState" [customSave]="saveState">
            </dxo-state-storing>

            <dxo-filter-row [visible]="true"></dxo-filter-row>
            <dxo-header-filter [visible]="true"></dxo-header-filter>
            <dxo-search-panel [visible]="true" [width]="240" [text]="searchResult" placeholder="Search...">
            </dxo-search-panel>
            <dxo-column-fixing [enabled]="true"></dxo-column-fixing>


            <dxo-toolbar>
                <dxi-item name="columnChooserButton"></dxi-item>
        <dxi-item name="exportButton"></dxi-item>
                <dxi-item name="resetButton">
                    <dx-button [disabled]="isUndo" icon="undo" hint="Reset All" class="ms-1"
                        (click)="onGridClickCancel()">
                    </dx-button>
                </dxi-item>
                <dxi-item name="searchPanel"></dxi-item>
            </dxo-toolbar>

            <dxi-column caption="Name" dataField="name" alignment="left" [allowHeaderFiltering]="false"
                [editorOptions]="editorOptions" [width]="300"></dxi-column>

            <dxi-column caption="Description" dataField="descr" alignment="left" [allowHeaderFiltering]="false"
                [editorOptions]="editorOptions"></dxi-column>

            <dxi-column caption="Batching Category" dataField="batchingCategoryId" [allowHeaderFiltering]="false"
                calculateSortValue="batchingCategoryId" [calculateDisplayValue]="getActiveBatchingCategory"
                dataType="string" [allowFiltering]="true">
                <dxo-lookup [dataSource]="batchingCategoryLookupData" valueExpr="id" displayExpr="name"></dxo-lookup>
            </dxi-column>

            <dxi-column caption="IsActive" dataField="isActive" alignment="left" [allowHeaderFiltering]="false"
                [editorOptions]="editorOptions" [width]="150"></dxi-column>

            <dxi-column caption="Sort" dataField="sort" alignment="left" [allowHeaderFiltering]="false"
                [editorOptions]="editorOptions" [width]="150"></dxi-column>


            <dxi-column *hasPermission="['UPBATCHINGFAMILY', 'DEBATCHINGFAMILY']" caption="Actions" [allowHiding]="false"
                [allowFixing]="true"
                fixedPosition="right" type="buttons"
                [fixed]="true">
                <dxi-button hint="Edit" icon="edit" [onClick]="onClickEditBatchingFamily"
                    *hasPermission="'UPBATCHINGFAMILY'">
                </dxi-button>
                <dxi-button hint="Delete" icon="trash" [onClick]="onClickDeleteBatchingFamily"
                    *hasPermission="'DEBATCHINGFAMILY'">
                </dxi-button>
            </dxi-column>

            <dxo-scrolling mode="virtual" [renderAsync]="false">
            </dxo-scrolling>
            <dxo-paging [pageSize]="150" [pageIndex]="0"></dxo-paging>
            <dxo-pager [visible]="true" [showInfo]="true" infoText="Total - {2} items"> </dxo-pager>

        </dx-data-grid>
        <div class="custom-datagrid-pager-wrapper" *ngIf="gridCount">
            <app-single-select placeholder="Select Page Size" [clearable]="false" [trackByFn]="pageSizeTrackByFn"
                [getOptionLabelFn]="getPageSizeOptionLabelFn" [options]="pageSizeOptions"
                (onSelect)="onSelectPageSize()" [(ngModel)]="selectedPageSize">
            </app-single-select>
        </div>
    </div>
</main>